<div class="px-5">

    <div class="pb-2">
    </div>

    <form [formGroup]="formOperationalDetail">
        <div class="p-fluid grid">

            <!-- Detalle Operativo -->
            <div class="field col-12 md:col-4 py-4">
                <span class="p-float-label">
                    <p-dropdown
                        [class]="validateService.validate(formOperationalDetail.controls['operational_detail'])"
                        [options]="lOperationDetail"
                        [autoDisplayFirst]="false"
                        optionValue="id"
                        optionLabel="description"
                        formControlName="operational_detail"
                        [showClear]="true"
                        [filter]="true"
                        (onChange)="onChangeDetailOp()"
                        appendTo="body"
                        >
                    </p-dropdown>
                    <label>Detalle Operativo</label>
                </span>
                <error-message [formControlError]="formOperationalDetail.controls['operational_detail']"></error-message>
            </div>

            <!-- Agrupador -->
            <div class="field col-12 md:col-4 py-4">
                <span class="p-float-label">
                    <p-dropdown
                        [class]="validateService.validate(formOperationalDetail.controls['grouper'])"
                        [options]="lGrouperOperationalDetail"
                        [autoDisplayFirst]="false"
                        optionValue="id"
                        optionLabel="description"
                        formControlName="grouper"
                        [showClear]="true"
                        [filter]="true"
                        appendTo="body"
                        >
                    </p-dropdown>
                    <label>Agrupador</label>
                </span>
            </div>

            <!-- Unidad -->
            <div class="field col-12 md:col-4 py-4">
                <span class="p-float-label">
                    <p-dropdown
                        [class]="validateService.validate(formOperationalDetail.controls['unit_measure'])"
                        [options]="lUnitMeasure"
                        [autoDisplayFirst]="false"
                        optionValue="id"
                        optionLabel="description"
                        formControlName="unit_measure"
                        [showClear]="true"
                        [filter]="true"
                        appendTo="body"
                        >
                    </p-dropdown>
                    <label>Unidad</label>
                </span>
                <error-message [formControlError]="formOperationalDetail.controls['unit_measure']"></error-message>
            </div>

            <!-- Tarifa -->
            <div class="field col-12 md:col-4">
                <span class="p-float-label">
                    <p-inputNumber
                        [class]="validateService.validate(formOperationalDetail.controls['tariff'])"
                        formControlName="tariff"
                        [min]="0"
                        mode="currency"
                        currency="{{isDollarSelected? 'USD' : 'PEN'}}"
                        locale="{{isDollarSelected? 'en-US' : 'es-PE'}}"
                        [minFractionDigits]="2"
                        [maxFractionDigits]="3"
                        (onInput)="calculateSubtotalPriceForTarif($event.value)">
                    </p-inputNumber>
                    <label>Tarifa</label>
                </span>
                <error-message [formControlError]="formOperationalDetail.controls['tariff']"></error-message>
            </div>

            <!-- Consumo -->
            <div class="field col-12 md:col-4 " >
                <span class="p-float-label">
                    <p-inputNumber 
                        [class]="validateService.validate(formOperationalDetail.controls['quantity'])"
                        class="align-self-start"
                        formControlName="quantity"
                        [minFractionDigits]="2"
                        [maxFractionDigits]="3"
                        [min]="1"
                        locale="es-PE"
                        (onInput)="calculateSubtotalPrice($event)"
                    ></p-inputNumber>
                    <label>Cantidad</label>
                </span>
                <error-message [min]="1" [formControlError]="formOperationalDetail.controls['quantity']"></error-message>
            </div>

            <!-- Subtotal -->
            <div class="field col-12 md:col-4">
                <span class="p-float-label">
                    <p-inputNumber
                        [class]="validateService.validate(formOperationalDetail.controls['subtotal_price'])"
                        formControlName="subtotal_price"
                        mode="currency"
                        currency="{{isDollarSelected? 'USD' : 'PEN'}}"
                        locale="{{isDollarSelected? 'en-US' : 'es-PE'}}"
                        [minFractionDigits]="2"
                        [maxFractionDigits]="2"
                        [readonly]="true">
                    </p-inputNumber>
                    <label>Subtotal</label>
                </span>
            </div>

        </div>
    </form>

    <div class="col-12 text-center py-3">
        <button pButton class="b-primary px-5 py-2 focus-visible-button focus-visible-general" label="Crear detalle operativo" (click)="registerOperationalDetail()">
        </button>
    </div>
</div>
